# Ultra-quick demo preset (≈5MB) — fast end-to-end run
models:
  source_tokenizer: "BioMistral/BioMistral-7B"
  target_tokenizer: "mistralai/Mistral-7B-v0.3"
  source_model: "BioMistral/BioMistral-7B"

corpus:
  size_gb: 0.05    # ~50MB quick smoke test
  byte_budget: 0   # 0 = derive from size_gb
  deduplicate: true
  hash_name: "sha256"

term_mining:
  top_k: 500
  min_frequency: 5
  use_tfidf: false

embedding:
  backend: "fasttext"
  fasttext:
    epochs: 5
    mincount: 5
    lr: 0.05
    thread: null

alignment:
  pivot_count: 300
  similarity_threshold: 0.3

tokenization:
  workers: null
  cache_dir: null
  min_line_length: 0

# TokAlign vocabulary adaptation (two-stage fine-tune)
vocab_adaptation:
  enabled: true
  stage1_steps: 10   # Minimal for smoke test
  stage2_steps: 10   # Minimal for smoke test
  lr_stage1: 0.00064
  lr_stage2: 0.00005
  batch_size: 2
  gradient_accumulation: 8
  max_seq_length: 1024
  train_start_idx_stage2: 5120   # Minimal offset for smoke test
  seed: 0
  use_flash_attn: false  # Opt-in: enable if flash-attn is installed (often fails on ARM64/GH200)
  bf16: false

# Evaluation (disabled for demo speed)
evaluation:
  enabled: false
  datasets: []
  max_samples: 128
  qa: false

pipeline:
  run_root: "runs/tokenizer_adapt"
  max_retries: 1
  retry_backoff: 5.0


